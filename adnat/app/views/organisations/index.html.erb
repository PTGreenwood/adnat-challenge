<%= render "layouts/partials/header" %>
Logged in as <%= current_user.name %> <%= link_to 'Logout' %><br>
<br>
<!-- If User not in Organisation display all organisations -->
<% if current_user.organisation_id.nil?%>
  You aren't a member of any organisations. <br>
  Join an existing one or create a new one.
  <h2> Organisations</h2>
  <ul>
    <% @organisation.each do |organisation| %>
      <li><%= organisation.name %> at <strong>$<%= organisation.hourly_rate %></strong>
        <%#= link_to 'Show', organisation_path(organisation) %>
        <%= link_to 'Edit', edit_organisation_path(organisation) %>
        <%= link_to 'Join', "organisations/join/#{organisation.id}"%><br>
        <% organisation.users.each do |user| %>
          <%= user.name %>
        <% end %>
      </li>
    <% end %>
  </ul>
  <!-- Not in one. So create an organisation -->
  <h2> Create Organisation </h2>
  <%= form_for (@creationOrganisation) do |organisation_form| %>
    <% if @creationOrganisation.errors.any? %>
      <div id="error_explanation">
        <% @creationOrganisation.errors.full_messages.each do |msg| %>
          <span style="color: red"><strong>Notice: </strong></span>
          <%= msg %><br>
        <% end %>
      </div>
    <% end %>
    <p>
      <%= organisation_form.label :name %>
      <%= organisation_form.text_field :name %>
      <br>
      <%= organisation_form.label :hourly_rate %>
      <%= organisation_form.text_field :hourly_rate %>
      <br>
      <%= organisation_form.submit "Create and Join" %>
    </p>
  <% end %>
  <!-- Else -->
<% else %>
  <h2> <%= @organisation.name %> </h2>
  <p>
    View Shifts
    <%= link_to 'Edit', edit_organisation_path(@organisation.id) %>
    Leave
  </p>
<% end %>
