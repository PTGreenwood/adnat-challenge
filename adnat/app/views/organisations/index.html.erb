<%= render "layouts/partials/header" %>
Logged in as User?<br>
<br>
<!-- If User not in Organisation display all organisations -->
<% if 1 == 1 %>
  You aren't a member of any organisations. <br>
  Join an existing one or create a new one.
  <h2> Organisations</h2>
  <ul>
    <% @organisation.each do |organisation| %>
      <li><%= organisation.name %> at <strong>$<%= organisation.hourly_rate %></strong>
        <%#= link_to 'Show', organisation_path(organisation) %>
        <%= link_to 'Edit', edit_organisation_path(organisation) %>
        <%= link_to 'Join', edit_organisation_path(organisation) %>
      </li>
    <% end %>
  </ul>
  <!-- Not in one. So create an organisation -->
  <h2> Create Organisation </h2>
  <%= form_for (@creationOrganisation) do |organisation_form| %>
    <% if @creationOrganisation.errors.any? %>
      <div id="error_explanation">
        <% @creationOrganisation.errors.full_messages.each do |msg| %>
          <span style="color: red"><strong>Notice: </strong></span>
          <%= msg %><br>
        <% end %>
      </div>
    <% end %>
    <p>
      <%= organisation_form.label :name %>
      <%= organisation_form.text_field :name %>
      <br>
      <%= organisation_form.label :hourly_rate %>
      <%= organisation_form.text_field :hourly_rate %>
      <br>
      <%= organisation_form.submit "Create and Join" %>
    </p>
  <% end %>
  <!-- Else -->
<% else %>
  <!-- Display edit -->
  <%= form_with(model: @organisation, local: true) do |organisation_form| %>
    <% if @organisation.errors.any? %>
      <div id="error_explanation">
        <% @organisation.errors.full_messages.each do |msg| %>
          <span style="color: red"><strong>Notice: </strong></span>
          <%= msg %><br>
        <% end %>
      </div>
    <% end %>
    <p>
      <%= organisation_form.label :name %>
      <%= organisation_form.text_field :name %>
      <br>
      <%= organisation_form.label :hourly_rate %>
      <%= organisation_form.text_field :hourly_rate %>
      <br>
      <%= organisation_form.submit "Update" %>
    </p>
    <%= link_to 'Destroy', organisation_path(@organisation),
              method: :delete,
              data: { confirm: 'Are you sure?' } %>
  <% end %>
<% end %>
